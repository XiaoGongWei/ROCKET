#include <iostream>

#include "Vector.hpp"
#include "Matrix.hpp"


using namespace std;
using namespace gpstk;


int main(void)
{
    Matrix<double> amat(15,15,0.0);
    amat(0,0) = 4085.5897971309246;
    amat(0,1) = -4604.9603032414680;
    amat(0,2) = 773.32585511758930;
    amat(0,3) = 24670622.756099138;
    amat(0,4) = 11803814.318307959;
    amat(0,5) = -36733360.375970729;
    amat(0,6) = 24.567170557803870;
    amat(0,7) = -0.85640900897133077;
    amat(0,8) = -24.511090364896326;
    amat(0,9) = 1.9525440713021402;
    amat(0,10) = 3.6342396985767174;
    amat(0,11) = 7.7508808702540986;
    amat(0,12) = 24.585947672031505;
    amat(0,13) = 7.6224369669026126;
    amat(0,14) = 1.4778545766419440;

    amat(1,0) = -4604.9603032414680;
    amat(1,1) = 5500.6636664701864;
    amat(1,2) = -1109.8731891435896;
    amat(1,3) = -27195447.353941713;
    amat(1,4) = -15787181.977161136;
    amat(1,5) = 43382800.807863705;
    amat(1,6) = -29.803419610619102;
    amat(1,7) = -1.9361200975496817;
    amat(1,8) = 28.935478875094084;
    amat(1,9) = -1.9083393680460725;
    amat(1,10) = -4.7811838472282622;
    amat(1,11) = -5.9785630098622606;
    amat(1,12) = -29.039089893082277;
    amat(1,13) = -8.9341235247087845;
    amat(1,14) = 0.71621894911587292;

    amat(2,0) = 773.32585511758930;
    amat(2,1) = -1109.8731891435896;
    amat(2,2) = 425.73939565675272;
    amat(2,3) = 3802797.9640347329;
    amat(2,4) = 4705615.8467875319;
    amat(2,5) = -8659749.4365441967;
    amat(2,6) = 6.3277525724898380;
    amat(2,7) = 2.8793025591807697;
    amat(2,8) = -5.7462312070536159;
    amat(2,9) = 7.05757539217425345E-002;
    amat(2,10) = 1.3488390608732841;
    amat(2,11) = -1.4524447297474556;
    amat(2,12) = 6.0296019055134131;
    amat(2,13) = 1.6297194550169705;
    amat(2,14) = -2.2301431605449804;

    amat(3,0) = 24670622.756099138;
    amat(3,1) = -27195447.353941713;
    amat(3,2) = 3802797.9640347329;
    amat(3,3) = 155764030916.99179;
    amat(3,4) = 64790799039.521660;
    amat(3,5) = -219634769009.93115;
    amat(3,6) = 148250.52182228435;
    amat(3,7) = -28097.649244131739;
    amat(3,8) = -147100.19436245770;
    amat(3,9) = 11852.513145493946;
    amat(3,10) = 13714.258012249848;
    amat(3,11) = 60266.206722970965;
    amat(3,12) = 147873.01906337231;
    amat(3,13) = 45798.933106165954;
    amat(3,14) = 20136.802996083341;

    amat(4,0) = 11803814.318307959;
    amat(4,1) = -15787181.977161136;
    amat(4,2) = 4705615.8467875319;
    amat(4,3) = 64790799039.521660;
    amat(4,4) = 60139743159.619301;
    amat(4,5) = -124471654615.69635;
    amat(4,6) = 93086.806137942200;
    amat(4,7) = 42030.261920411322;
    amat(4,8) = -83086.683062961398;
    amat(4,9) = 2015.5456512273743;
    amat(4,10) = 24160.769228426532;
    amat(4,11) = -8843.3933988030367;
    amat(4,12) = 87070.539443055997;
    amat(4,13) = 24051.114665783276;
    amat(4,14) = -22061.759915843963;

    amat(5,0) = -36733360.375970729;
    amat(5,1) = 43382800.807863705;
    amat(5,2) = -8659749.4365441967;
    amat(5,3) = -219634769009.93115;
    amat(5,4) = -124471654615.69635;
    amat(5,5) = 349402421580.30035;
    amat(5,6) = -243742.63882977524;
    amat(5,7) = -14327.433049587693;
    amat(5,8) = 231999.66094729706;
    amat(5,9) = -13996.899818413965;
    amat(5,10) = -39845.544684378023;
    amat(5,11) = -51450.302376389642;
    amat(5,12) = -236865.85393847857;
    amat(5,13) = -70094.333785885494;
    amat(5,14) = 3530.0923266802943;

    amat(6,0) = 24.567170557803870;
    amat(6,1) = -29.803419610619102;
    amat(6,2) = 6.3277525724898380;
    amat(6,3) = 148250.52182228435;
    amat(6,4) = 93086.806137942200;
    amat(6,5) = -243742.63882977524;
    amat(6,6) = 0.24865523322389593;
    amat(6,7) = 7.13525320670372332E-002;
    amat(6,8) = -0.15960900515171961;
    amat(6,9) = 7.39974475553071935E-003;
    amat(6,10) = 5.38760358890375268E-002;
    amat(6,11) = 2.05766789046462721E-002;
    amat(6,12) = 0.21164870342029832;
    amat(6,13) = 3.52725760264242238E-002;
    amat(6,14) = -1.31986272207214560E-002;

    amat(7,0) = -0.85640900897133077;
    amat(7,1) = -1.9361200975496817;
    amat(7,2) = 2.8793025591807697;
    amat(7,3) = -28097.649244131739;
    amat(7,4) = 42030.261920411322;
    amat(7,5) = -14327.433049587693;
    amat(7,6) = 7.13525320670372332E-002;
    amat(7,7) = 0.58995665644813056;
    amat(7,8) = -6.85395662942141215E-003;
    amat(7,9) = -1.04456117224712205E-002;
    amat(7,10) = 0.26530584783063060;
    amat(7,11) = -0.19422896760185623;
    amat(7,12) = 4.12005805031438813E-002;
    amat(7,13) = -7.57816947017682201E-003;
    amat(7,14) = -0.14570552703168163;

    amat(8,0) = -24.511090364896326;
    amat(8,1) = 28.935478875094084;
    amat(8,2) = -5.7462312070536159;
    amat(8,3) = -147100.19436245770;
    amat(8,4) = -83086.683062961398;
    amat(8,5) = 231999.66094729706;
    amat(8,6) = -0.15960900515171961;
    amat(8,7) = -6.85395662942141215E-003;
    amat(8,8) = 0.15650174329478769;
    amat(8,9) = -7.78234902848098844E-003;
    amat(8,10) = -2.51010988336428098E-002;
    amat(8,11) = -3.48894963325106014E-002;
    amat(8,12) = -0.15657881085171721;
    amat(8,13) = -4.69317400865698342E-002;
    amat(8,14) = 1.51799537293862102E-003;

    amat(9,0) = 1.9525440713021402;
    amat(9,1) = -1.9083393680460725;
    amat(9,2) = 7.05757539217425345E-002;
    amat(9,3) = 11852.513145493946;
    amat(9,4) = 2015.5456512273743;
    amat(9,5) = -13996.899818413965;
    amat(9,6) = 7.39974475553071935E-003;
    amat(9,7) = -1.04456117224712205E-002;
    amat(9,8) = -7.78234902848098844E-003;
    amat(9,9) = 3.65015197729535393E-003;
    amat(9,10) = -2.67437355753274639E-003;
    amat(9,11) = 8.50660169514725652E-003;
    amat(9,12) = 8.04217215412262112E-003;
    amat(9,13) = 3.72897211807990490E-003;
    amat(9,14) = 4.76330511355471577E-003;

    amat(10,0) = 3.6342396985767174;
    amat(10,1) = -4.7811838472282622;
    amat(10,2) = 1.3488390608732841;
    amat(10,3) = 13714.258012249848;
    amat(10,4) = 24160.769228426532;
    amat(10,5) = -39845.544684378023;
    amat(10,6) = 5.38760358890375268E-002;
    amat(10,7) = 0.26530584783063060;
    amat(10,8) = -2.51010988336428098E-002;
    amat(10,9) = -2.67437355753274639E-003;
    amat(10,10) = 0.12882359389092443;
    amat(10,11) = -7.55315333686699120E-002;
    amat(10,12) = 4.07362396114361661E-002;
    amat(10,13) = 3.32143392765661596E-003;
    amat(10,14) = -6.03522328665222069E-002;

    amat(11,0) = 7.7508808702540986;
    amat(11,1) = -5.9785630098622606;
    amat(11,2) = -1.4524447297474556;
    amat(11,3) = 60266.206722970965;
    amat(11,4) = -8843.3933988030367;
    amat(11,5) = -51450.302376389642;
    amat(11,6) = 2.05766789046462721E-002;
    amat(11,7) = -0.19422896760185623;
    amat(11,8) = -3.48894963325106014E-002;
    amat(11,9) = 8.50660169514725652E-003;
    amat(11,10) = -7.55315333686699120E-002;
    amat(11,11) = 0.11094932169118879;
    amat(11,12) = 2.94441675835505935E-002;
    amat(11,13) = 1.27302436940147194E-002;
    amat(11,14) = 7.65678182480967334E-002;

    amat(12,0) = 24.585947672031505;
    amat(12,1) = -29.039089893082277;
    amat(12,2) = 6.0296019055134131;
    amat(12,3) = 147873.01906337231;
    amat(12,4) = 87070.539443055997;
    amat(12,5) = -236865.85393847857;
    amat(12,6) = 0.21164870342029832;
    amat(12,7) = 4.12005805031438813E-002;
    amat(12,8) = -0.15657881085171721;
    amat(12,9) = 8.04217215412262112E-003;
    amat(12,10) = 4.07362396114361661E-002;
    amat(12,11) = 2.94441675835505935E-002;
    amat(12,12) = 0.19111580687799468;
    amat(12,13) = 3.83344399119009901E-002;
    amat(12,14) = -5.94241192778945711E-003;

    amat(13,0) = 7.6224369669026126;
    amat(13,1) = -8.9341235247087845;
    amat(13,2) = 1.6297194550169705;
    amat(13,3) = 45798.933106165954;
    amat(13,4) = 24051.114665783276;
    amat(13,5) = -70094.333785885494;
    amat(13,6) = 3.52725760264242238E-002;
    amat(13,7) = -7.57816947017682201E-003;
    amat(13,8) = -4.69317400865698342E-002;
    amat(13,9) = 3.72897211807990490E-003;
    amat(13,10) = 3.32143392765661596E-003;
    amat(13,11) = 1.27302436940147194E-002;
    amat(13,12) = 3.83344399119009901E-002;
    amat(13,13) = 1.73523396519893111E-002;
    amat(13,14) = 1.18744633846590633E-003;

    amat(14,0) = 1.4778545766419440;
    amat(14,1) = 0.71621894911587292;
    amat(14,2) = -2.2301431605449804;
    amat(14,3) = 20136.802996083341;
    amat(14,4) = -22061.759915843963;
    amat(14,5) = 3530.0923266802943;
    amat(14,6) = -1.31986272207214560E-002;
    amat(14,7) = -0.14570552703168163;
    amat(14,8) = 1.51799537293862102E-003;
    amat(14,9) = 4.76330511355471577E-003;
    amat(14,10) = -6.03522328665222069E-002;
    amat(14,11) = 7.65678182480967334E-002;
    amat(14,12) = -5.94241192778945711E-003;
    amat(14,13) = 1.18744633846590633E-003;
    amat(14,14) = 5.79124656413573108E-002;

    Vector<double> bvec(15,0.0);
    bvec(0) = 0.29991979249606571;
    bvec(1) = -0.35419492311979012;
    bvec(2) = 7.00970230582916853E-002;
    bvec(3) = 1776.0438154721230;
    bvec(4) = 1004.1007074524554;
    bvec(5) = -2803.0499633204522;
    bvec(6) = 1.84863258312902815E-003;
    bvec(7) = 1.42233737163649504E-004;
    bvec(8) = -1.85146586950373773E-003;
    bvec(9) = 1.48581403590108794E-004;
    bvec(10) = 3.24975679232982005E-004;
    bvec(11) = 3.56610653083545023E-004;
    bvec(12) = 1.82434623104927923E-003;
    bvec(13) = 5.97533299254105572E-004;
    bvec(14) = -6.63951313422005065E-005;


    Vector<double> dx = inverse(amat) * bvec;

    cout << fixed << setprecision(12);

    for(int i=0; i<15; ++i)
    {
        cout << setw(20) << dx(i) << endl;
    }

    return 0;
}
